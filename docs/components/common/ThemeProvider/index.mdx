import { ThemeProvider, useTheme } from '@taro-uno/ui';
import ThemeProviderExample from './examples/index';

<Meta title="通用组件 / ThemeProvider 主题提供者" description="提供全局主题管理和暗色模式支持" />

<Description>
  ThemeProvider 组件提供了全局主题管理功能，支持亮色/暗色模式切换，以及基于设计令牌的样式系统。
</Description>

<CodeExample title="基本用法">
  <ThemeProviderExample />
  <ExampleCode>
  ```tsx
  import React from 'react';
  import { ThemeProvider } from '@taro-uno/ui';
  
  export default function App() {
    return (
      <ThemeProvider>
        {/* 应用内容 */}
      </ThemeProvider>
    );
  }
  ```
  </ExampleCode>
</CodeExample>

## 功能介绍

ThemeProvider 组件提供了以下核心功能：

### 主题切换
- 支持亮色模式
- 支持暗色模式
- 支持自动模式（根据系统设置）

### 设计令牌
- 基于设计系统的颜色、间距、排版
- 通过 CSS 变量全局注入
- 支持动态更新

### 主题上下文
- 提供 useTheme Hook 访问主题状态
- 响应式主题变化

### 多平台适配
- 支持 Web、小程序、React Native
- 平台特定样式调整

## API

### ThemeProviderProps

| 属性 | 类型 | 默认值 | 说明 |
| --- | --- | --- | --- |
| children | ReactNode | - | 应用内容 |
| defaultTheme | 'light' \| 'dark' \| 'auto' | 'auto' | 默认主题模式 |

### ThemeContextType

| 属性 | 类型 | 说明 |
| --- | --- | --- |
| theme | 'light' \| 'dark' \| 'auto' | 当前主题模式 |
| setTheme | (theme: 'light' \| 'dark' \| 'auto') => void | 设置主题模式 |
| isDark | boolean | 当前是否为暗色模式 |
| colors | Record<string, any> | 颜色设计令牌 |
| spacing | Record<string, number> | 间距设计令牌 |
| typography | Record<string, any> | 排版设计令牌 |

### useTheme Hook

```tsx
const { theme, setTheme, isDark, colors, spacing, typography } = useTheme();
```

## 使用示例

### 基本用法

```tsx
import { ThemeProvider } from '@taro-uno/ui';

function App() {
  return (
    <ThemeProvider>
      {/* 应用内容 */}
    </ThemeProvider>
  );
}
```

### 自定义默认主题

```tsx
import { ThemeProvider } from '@taro-uno/ui';

function App() {
  return (
    <ThemeProvider defaultTheme="dark">
      {/* 应用内容 */}
    </ThemeProvider>
  );
}
```

### 主题切换

```tsx
import { useTheme } from '@taro-uno/ui';
import { View, Button } from '@tarojs/components';
import React from 'react';

function ThemeSwitcher() {
  const { theme, setTheme } = useTheme();

  return (
    <View>
      <Button onClick={() => setTheme('light')}>
        亮色模式
      </Button>
      <Button onClick={() => setTheme('dark')}>
        暗色模式
      </Button>
      <Button onClick={() => setTheme('auto')}>
        自动模式
      </Button>
      <View>当前主题: {theme}</View>
    </View>
  );
}
```

### 使用主题上下文

```tsx
import { useTheme } from '@taro-uno/ui';
import { View, Text } from '@tarojs/components';
import React from 'react';

function ThemeAwareComponent() {
  const { isDark, colors } = useTheme();

  return (
    <View style={{ backgroundColor: isDark ? colors.background.primary : '#fff', padding: '20px' }}>
      <Text style={{ color: isDark ? colors.text.primary : '#000' }}>
        这个组件会根据当前主题自动调整样式
      </Text>
    </View>
  );
}
```

### 使用设计令牌

```tsx
import { useTheme } from '@taro-uno/ui';
import { View, Text, Button } from '@tarojs/components';
import React from 'react';

function DesignTokensExample() {
  const { colors, spacing, typography } = useTheme();

  return (
    <View style={{ padding: spacing.md }}>
      <Text style={{ fontSize: typography.h2.fontSize, fontWeight: typography.h2.fontWeight }}>
        标题
      </Text>
      <Text style={{ marginBottom: spacing.sm, color: colors.text.secondary }}>
        副标题
      </Text>
      <Button style={{ backgroundColor: colors.primary, color: '#fff' }}>
        按钮
      </Button>
    </View>
  );
}
```

## 使用提示

1. **全局使用**：在应用的根组件中使用 ThemeProvider，为整个应用提供主题支持。

2. **主题切换**：使用 setTheme 方法动态切换主题，所有使用主题的组件会自动更新。

3. **主题感知组件**：使用 useTheme Hook 创建主题感知组件，根据当前主题调整样式。

4. **设计令牌**：利用设计令牌确保应用样式的一致性，减少硬编码值。

5. **暗色模式**：在暗色模式下，系统会自动更新颜色变量，确保良好的视觉体验。

6. **自动模式**：默认的自动模式会根据用户的系统设置自动切换亮色/暗色模式。

## 浏览器兼容性

| 浏览器 | 版本 | 支持情况 |
| --- | --- | --- |
| Chrome | 80+ | ✅ |
| Firefox | 75+ | ✅ |
| Safari | 13+ | ✅ |
| Edge | 80+ | ✅ |
| 微信小程序 | 基础库 2.10+ | ✅ |
| 支付宝小程序 | 基础库 2.7+ | ✅ |
| React Native | 0.60+ | ✅ |

## 无障碍支持

- 支持系统主题设置
- 暗色模式符合 WCAG 对比度标准
- 主题切换提供清晰的视觉反馈
- 不影响屏幕阅读器的使用
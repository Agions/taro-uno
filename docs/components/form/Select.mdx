# Select 选择器

提供一组选项供用户选择。

## 功能介绍

Select 组件是表单中常用的选择组件，提供了多种选择模式和样式，适用于各种选择场景：

- 单选选择器
- 多选选择器
- 带搜索功能的选择器
- 分组选项
- 自定义选项内容
- 各种状态和尺寸

## 基本用法

### 单选选择器

```tsx
import React, { useState } from 'react';
import { Select } from '@/components/form/Select';

const App = () => {
  const [value, setValue] = useState('');

  const options = [
    { label: '选项一', value: '1' },
    { label: '选项二', value: '2' },
    { label: '选项三', value: '3' },
  ];

  const handleChange = (value: string) => {
    setValue(value);
  };

  return (
    <Select
      value={value}
      onChange={handleChange}
      options={options}
      placeholder="请选择"
    />
  );
};

export default App;
```

### 受控组件

```tsx
import React, { useState } from 'react';
import { Select } from '@/components/form/Select';

const App = () => {
  const [value, setValue] = useState('2');

  const options = [
    { label: '选项一', value: '1' },
    { label: '选项二', value: '2' },
    { label: '选项三', value: '3' },
  ];

  const handleChange = (value: string) => {
    setValue(value);
  };

  return (
    <Select
      value={value}
      onChange={handleChange}
      options={options}
      placeholder="请选择"
    />
  );
};

export default App;
```

### 禁用状态

```tsx
import React from 'react';
import { Select } from '@/components/form/Select';

const App = () => {
  const options = [
    { label: '选项一', value: '1' },
    { label: '选项二', value: '2' },
    { label: '选项三', value: '3' },
  ];

  return (
    <Select
      options={options}
      placeholder="禁用选择器"
      disabled
    />
  );
};

export default App;
```

### 带清除按钮

```tsx
import React, { useState } from 'react';
import { Select } from '@/components/form/Select';

const App = () => {
  const [value, setValue] = useState('1');

  const options = [
    { label: '选项一', value: '1' },
    { label: '选项二', value: '2' },
    { label: '选项三', value: '3' },
  ];

  const handleChange = (value: string) => {
    setValue(value);
  };

  const handleClear = () => {
    setValue('');
  };

  return (
    <Select
      value={value}
      onChange={handleChange}
      options={options}
      placeholder="请选择"
      clearable
      onClear={handleClear}
    />
  );
};

export default App;
```

### 不同尺寸

```tsx
import React, { useState } from 'react';
import { Select } from '@/components/form/Select';
import { View } from '@tarojs/components';

const App = () => {
  const [value1, setValue1] = useState('');
  const [value2, setValue2] = useState('');
  const [value3, setValue3] = useState('');

  const options = [
    { label: '选项一', value: '1' },
    { label: '选项二', value: '2' },
    { label: '选项三', value: '3' },
  ];

  return (
    <View style={{ display: 'flex', flexDirection: 'column', gap: 10 }}>
      <Select
        value={value1}
        onChange={setValue1}
        options={options}
        placeholder="大号选择器"
        size="large"
      />
      <Select
        value={value2}
        onChange={setValue2}
        options={options}
        placeholder="中号选择器"
        size="medium"
      />
      <Select
        value={value3}
        onChange={setValue3}
        options={options}
        placeholder="小号选择器"
        size="small"
      />
    </View>
  );
};

export default App;
```

### 带标签

```tsx
import React, { useState } from 'react';
import { Select } from '@/components/form/Select';

const App = () => {
  const [value, setValue] = useState('');

  const options = [
    { label: '选项一', value: '1' },
    { label: '选项二', value: '2' },
    { label: '选项三', value: '3' },
  ];

  return (
    <Select
      value={value}
      onChange={setValue}
      options={options}
      placeholder="请选择"
      label="选择器标签"
    />
  );
};

export default App;
```

### 验证状态

```tsx
import React, { useState } from 'react';
import { Select } from '@/components/form/Select';
import { View } from '@tarojs/components';

const App = () => {
  const [value1, setValue1] = useState('');
  const [value2, setValue2] = useState('1');
  const [value3, setValue3] = useState('');
  const [value4, setValue4] = useState('');

  const options = [
    { label: '选项一', value: '1' },
    { label: '选项二', value: '2' },
    { label: '选项三', value: '3' },
  ];

  return (
    <View style={{ display: 'flex', flexDirection: 'column', gap: 10 }}>
      <Select
        value={value1}
        onChange={setValue1}
        options={options}
        placeholder="默认状态"
      />
      <Select
        value={value2}
        onChange={setValue2}
        options={options}
        placeholder="成功状态"
        status="success"
      />
      <Select
        value={value3}
        onChange={setValue3}
        options={options}
        placeholder="警告状态"
        status="warning"
        errorMessage="请选择正确的选项"
      />
      <Select
        value={value4}
        onChange={setValue4}
        options={options}
        placeholder="错误状态"
        status="error"
        errorMessage="必须选择一个选项"
      />
    </View>
  );
};

export default App;
```

### 自定义验证

```tsx
import React, { useState } from 'react';
import { Select } from '@/components/form/Select';

const App = () => {
  const [value, setValue] = useState('');
  const [status, setStatus] = useState<'success' | 'warning' | 'error' | ''>('');
  const [errorMessage, setErrorMessage] = useState('');

  const options = [
    { label: '选项一', value: '1' },
    { label: '选项二', value: '2' },
    { label: '选项三', value: '3' },
  ];

  const handleChange = (value: string) => {
    setValue(value);
    if (value === '2') {
      setStatus('error');
      setErrorMessage('选项二不可选');
    } else if (value) {
      setStatus('success');
      setErrorMessage('');
    } else {
      setStatus('');
      setErrorMessage('');
    }
  };

  return (
    <Select
      value={value}
      onChange={handleChange}
      options={options}
      placeholder="请选择"
      status={status}
      errorMessage={errorMessage}
    />
  );
};

export default App;
```

### 分组选项

```tsx
import React, { useState } from 'react';
import { Select } from '@/components/form/Select';

const App = () => {
  const [value, setValue] = useState('');

  const options = [
    { 
      label: '分组一', 
      options: [
        { label: '选项一', value: '1' },
        { label: '选项二', value: '2' },
      ] 
    },
    { 
      label: '分组二', 
      options: [
        { label: '选项三', value: '3' },
        { label: '选项四', value: '4' },
      ] 
    },
  ];

  return (
    <Select
      value={value}
      onChange={setValue}
      options={options}
      placeholder="请选择"
    />
  );
};

export default App;
```

### 含禁用项

```tsx
import React, { useState } from 'react';
import { Select } from '@/components/form/Select';

const App = () => {
  const [value, setValue] = useState('');

  const options = [
    { label: '可选选项', value: '1' },
    { label: '禁用选项', value: '2', disabled: true },
    { label: '另一个可选选项', value: '3' },
  ];

  return (
    <Select
      value={value}
      onChange={setValue}
      options={options}
      placeholder="请选择"
    />
  );
};

export default App;
```

### 自定义显示文本

```tsx
import React, { useState } from 'react';
import { Select } from '@/components/form/Select';

const App = () => {
  const [value, setValue] = useState('');

  const options = [
    { label: '选项一', value: '1' },
    { label: '选项二', value: '2' },
    { label: '选项三', value: '3' },
  ];

  const formatLabel = (value: string) => {
    const option = options.find(opt => opt.value === value);
    return option ? `已选择：${option.label}` : '';
  };

  return (
    <Select
      value={value}
      onChange={setValue}
      options={options}
      placeholder="请选择"
      formatLabel={formatLabel}
    />
  );
};

export default App;
```

### 多选模式

```tsx
import React, { useState } from 'react';
import { Select } from '@/components/form/Select';

const App = () => {
  const [value, setValue] = useState<string[]>([]);

  const options = [
    { label: '选项一', value: '1' },
    { label: '选项二', value: '2' },
    { label: '选项三', value: '3' },
    { label: '选项四', value: '4' },
    { label: '选项五', value: '5' },
  ];

  return (
    <Select
      value={value}
      onChange={setValue}
      options={options}
      placeholder="请选择"
      multiple
    />
  );
};

export default App;
```

### 自定义空选项文本

```tsx
import React, { useState } from 'react';
import { Select } from '@/components/form/Select';

const App = () => {
  const [value, setValue] = useState('');
  const options: any[] = [];

  return (
    <Select
      value={value}
      onChange={setValue}
      options={options}
      placeholder="请选择"
      emptyText="暂无选项"
    />
  );
};

export default App;
```

### 加载状态

```tsx
import React, { useState } from 'react';
import { Select } from '@/components/form/Select';

const App = () => {
  const [value, setValue] = useState('');
  const [loading, setLoading] = useState(true);
  const [options, setOptions] = useState<any[]>([]);

  // 模拟异步加载数据
  React.useEffect(() => {
    const timer = setTimeout(() => {
      setOptions([
        { label: '选项一', value: '1' },
        { label: '选项二', value: '2' },
        { label: '选项三', value: '3' },
      ]);
      setLoading(false);
    }, 2000);

    return () => clearTimeout(timer);
  }, []);

  return (
    <Select
      value={value}
      onChange={setValue}
      options={options}
      placeholder="请选择"
      loading={loading}
    />
  );
};

export default App;
```

### 只读模式

```tsx
import React from 'react';
import { Select } from '@/components/form/Select';

const App = () => {
  const options = [
    { label: '选项一', value: '1' },
    { label: '选项二', value: '2' },
    { label: '选项三', value: '3' },
  ];

  return (
    <Select
      value="1"
      options={options}
      placeholder="请选择"
      readOnly
    />
  );
};

export default App;
```

### 不同变体

```tsx
import React, { useState } from 'react';
import { Select } from '@/components/form/Select';
import { View } from '@tarojs/components';

const App = () => {
  const [value1, setValue1] = useState('');
  const [value2, setValue2] = useState('');
  const [value3, setValue3] = useState('');

  const options = [
    { label: '选项一', value: '1' },
    { label: '选项二', value: '2' },
    { label: '选项三', value: '3' },
  ];

  return (
    <View style={{ display: 'flex', flexDirection: 'column', gap: 10 }}>
      <Select
        value={value1}
        onChange={setValue1}
        options={options}
        placeholder="默认变体"
        variant="default"
      />
      <Select
        value={value2}
        onChange={setValue2}
        options={options}
        placeholder="填充变体"
        variant="filled"
      />
      <Select
        value={value3}
        onChange={setValue3}
        options={options}
        placeholder="轮廓变体"
        variant="outlined"
      />
    </View>
  );
};

export default App;
```

### 带前缀后缀

```tsx
import React, { useState } from 'react';
import { Select } from '@/components/form/Select';
import { Icon } from '@/components/basic/Icon';
import { View } from '@tarojs/components';

const App = () => {
  const [value1, setValue1] = useState('');
  const [value2, setValue2] = useState('');
  const [value3, setValue3] = useState('');

  const options = [
    { label: '选项一', value: '1' },
    { label: '选项二', value: '2' },
    { label: '选项三', value: '3' },
  ];

  return (
    <View style={{ display: 'flex', flexDirection: 'column', gap: 10 }}>
      <Select
        value={value1}
        onChange={setValue1}
        options={options}
        placeholder="带前缀"
        prefix={<Icon type="user" />}
      />
      <Select
        value={value2}
        onChange={setValue2}
        options={options}
        placeholder="带后缀"
        suffix={<Icon type="search" />}
      />
      <Select
        value={value3}
        onChange={setValue3}
        options={options}
        placeholder="带前后缀"
        prefix={<Icon type="lock" />}
        suffix={<Icon type="eye" />}
      />
    </View>
  );
};

export default App;
```

### 文本字段变体

```tsx
import React, { useState } from 'react';
import { Select } from '@/components/form/Select';

const App = () => {
  const [value, setValue] = useState('');

  const options = [
    { label: '选项一', value: '1' },
    { label: '选项二', value: '2' },
    { label: '选项三', value: '3' },
  ];

  return (
    <Select
      value={value}
      onChange={setValue}
      options={options}
      placeholder="文本字段变体"
      variant="textfield"
    />
  );
};

export default App;
```

## API

### SelectProps

| 参数 | 类型 | 默认值 | 说明 |
| --- | --- | --- | --- |
| value | `string \| string[]` | - | 选择器的值（单选为string，多选为string[]） |
| defaultValue | `string \| string[]` | - | 选择器的默认值 |
| options | `SelectOption[] \| SelectGroupOption[]` | [] | 选项列表 |
| placeholder | `string` | "请选择" | 占位符 |
| size | `'small' \| 'medium' \| 'large'` | `'medium'` | 选择器尺寸 |
| disabled | `boolean` | `false` | 是否禁用 |
| readOnly | `boolean` | `false` | 是否只读 |
| clearable | `boolean` | `false` | 是否显示清除按钮 |
| multiple | `boolean` | `false` | 是否支持多选 |
| loading | `boolean` | `false` | 是否显示加载状态 |
| status | `'success' \| 'warning' \| 'error' \| ''` | `''` | 选择器状态 |
| errorMessage | `string` | - | 错误提示信息 |
| label | `string \| React.ReactNode` | - | 选择器标签 |
| prefix | `React.ReactNode` | - | 前缀内容 |
| suffix | `React.ReactNode` | - | 后缀内容 |
| variant | `'default' \| 'filled' \| 'outlined' \| 'textfield'` | `'default'` | 选择器变体 |
| emptyText | `string \| React.ReactNode` | "暂无数据" | 无选项时的提示文本 |
| formatLabel | `(value: string \| string[]) => string` | - | 自定义选中项的显示文本 |
| onChange | `(value: string \| string[]) => void` | - | 值变化时的回调 |
| onClear | `() => void` | - | 点击清除按钮时的回调 |
| onOpen | `() => void` | - | 下拉菜单打开时的回调 |
| onClose | `() => void` | - | 下拉菜单关闭时的回调 |
| style | `Taro.RNViewStyle` | - | 自定义样式 |
| className | `string` | - | 自定义类名 |

### SelectRef

| 方法 | 说明 |
| --- | --- |
| open() | 打开下拉菜单 |
| close() | 关闭下拉菜单 |
| toggle() | 切换下拉菜单的开关状态 |
| clear() | 清空选择器的值 |
| getValue() | 获取选择器当前值 |
| setValue(value: string \| string[]) | 设置选择器的值 |

### 类型定义

```typescript
interface SelectOption {
  label: string \| React.ReactNode; // 选项文本
  value: string; // 选项值
  disabled?: boolean; // 是否禁用
  [key: string]: any; // 其他自定义属性
}

interface SelectGroupOption {
  label: string; // 分组标签
  options: SelectOption[]; // 分组选项列表
}

type SelectSize = 'small' | 'medium' | 'large';
type SelectStatus = 'success' | 'warning' | 'error' | '';
type SelectVariant = 'default' | 'filled' | 'outlined' | 'textfield';
```

## 使用提示

1. **单选 vs 多选**：
   - 默认是单选模式，设置 `multiple` 为 `true` 可以开启多选模式
   - 单选模式下 `value` 是字符串类型，多选模式下是字符串数组类型

2. **选项格式**：
   - 支持简单选项数组和分组选项数组
   - 简单选项数组：`[{ label: '选项一', value: '1' }]`
   - 分组选项数组：`[{ label: '分组一', options: [{ label: '选项一', value: '1' }] }]`

3. **禁用状态**：
   - 可以禁用整个选择器，设置 `disabled` 为 `true`
   - 也可以禁用单个选项，在选项对象中设置 `disabled: true`

4. **验证状态**：
   - 使用 `status` 属性可以提供视觉反馈
   - 配合 `errorMessage` 可以显示详细的错误信息

5. **自定义样式**：
   - 使用 `variant` 属性可以选择不同的外观变体
   - 使用 `style` 和 `className` 可以进行更精细的样式定制

6. **性能优化**：
   - 当选项数量较多时，考虑使用虚拟滚动
   - 避免在 `onChange` 事件中执行复杂逻辑

7. **无障碍访问**：
   - 为选择器添加适当的 `placeholder`
   - 确保选项有清晰的文本描述
   - 提供明确的验证反馈

8. **加载状态**：
   - 当选项需要异步加载时，可以使用 `loading` 属性显示加载状态
   - 配合 `emptyText` 可以提供更好的用户体验

9. **自定义显示**：
   - 使用 `formatLabel` 属性可以自定义选中项的显示文本
   - 使用 `prefix` 和 `suffix` 属性可以添加额外的视觉元素